<!-- Main content -->

    {{template "page-heading" 
        dict 
            "Title" (t "status.title") 
            "Subtitle" (t "status.subtitle") 
            "MarginBottom" "mb-8"
    }}

    <!-- Status Content Container -->
    <div class="max-w-7xl mx-auto px-6 lg:px-8">
        <!-- 90-Day History -->
        <div class="mb-8">
            <div class="hidden lg:flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">{{t "status.history"}}</h2>
                <!-- Legend -->
                <div class="flex items-center space-x-6 text-sm text-gray-600 dark:text-gray-300">
                    <div class="flex items-center relative" x-data="{ tooltipVisible: false }" @mouseenter="tooltipVisible = true" @mouseleave="tooltipVisible = false">
                        <div class="w-3 h-3 bg-green-500 rounded-sm mr-2"></div>
                        <span class="cursor-help">{{t "status.legend.operational"}}</span>
                        <div x-show="tooltipVisible" x-transition class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-50">
                            <div class="relative px-2 py-1 text-white bg-gray-900 rounded text-xs whitespace-nowrap">
                                {{t "status.uptime.operational"}}
                                <div class="absolute top-full left-1/2 -translate-x-1/2 -mt-px">
                                    <div class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[4px] border-t-gray-900"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center relative" x-data="{ tooltipVisible: false }" @mouseenter="tooltipVisible = true" @mouseleave="tooltipVisible = false">
                        <div class="w-3 h-3 bg-yellow-500 rounded-sm mr-2"></div>
                        <span class="cursor-help">{{t "status.legend.degraded"}}</span>
                        <div x-show="tooltipVisible" x-transition class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-50">
                            <div class="relative px-2 py-1 text-white bg-gray-900 rounded text-xs whitespace-nowrap">
                                {{t "status.uptime.degraded"}}
                                <div class="absolute top-full left-1/2 -translate-x-1/2 -mt-px">
                                    <div class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[4px] border-t-gray-900"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center relative" x-data="{ tooltipVisible: false }" @mouseenter="tooltipVisible = true" @mouseleave="tooltipVisible = false">
                        <div class="w-3 h-3 bg-red-500 rounded-sm mr-2"></div>
                        <span class="cursor-help">{{t "status.legend.outage"}}</span>
                        <div x-show="tooltipVisible" x-transition class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-50">
                            <div class="relative px-2 py-1 text-white bg-gray-900 rounded text-xs whitespace-nowrap">
                                {{t "status.uptime.outage"}}
                                <div class="absolute top-full left-1/2 -translate-x-1/2 -mt-px">
                                    <div class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[4px] border-t-gray-900"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="space-y-6">
                {{if .StatusData}}
                {{range .StatusData.Services}}
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex items-center">
                            <span class="relative flex h-3 w-3 mr-3">
                                {{/* Current status indicator - we'll use the last day's status as current */}}
                                {{$currentStatus := "operational"}}
                                {{if gt (len .Days) 0}}
                                    {{$lastIndex := 0}}
                                    {{range $i, $day := .Days}}
                                        {{$lastIndex = $i}}
                                    {{end}}
                                    {{$lastDay := index .Days $lastIndex}}
                                    {{$currentStatus = $lastDay.Status}}
                                {{end}}
                                {{if eq $currentStatus "operational"}}
                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 bg-green-500"></span>
                                <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
                                {{else if eq $currentStatus "degraded"}}
                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 bg-yellow-500"></span>
                                <span class="relative inline-flex rounded-full h-3 w-3 bg-yellow-500"></span>
                                {{else if eq $currentStatus "outage"}}
                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 bg-red-500"></span>
                                <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500"></span>
                                {{else}}
                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 bg-gray-400"></span>
                                <span class="relative inline-flex rounded-full h-3 w-3 bg-gray-400"></span>
                                {{end}}
                            </span>
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white">{{.Name}}</h3>
                        </div>
                        <span class="text-sm text-gray-500 dark:text-gray-400">{{printf "%.2f" .Uptime}}% {{t "status.uptimeLabel"}}</span>
                    </div>
                    <div class="hidden lg:flex space-x-1">
                        {{range .Days}}
                        <div 
                            x-data="{ tooltipVisible: false }"
                            @mouseenter="tooltipVisible = true"
                            @mouseleave="tooltipVisible = false"
                            class="relative">
                            
                            <div x-show="tooltipVisible" 
                                 x-cloak
                                 x-transition
                                 class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 z-50">
                                <div class="relative px-2 py-1 text-white bg-gray-900 rounded text-xs whitespace-nowrap">
                                    {{.Date}}<br>
                                    {{if eq .Status "operational"}}{{t "status.statuses.operational"}}{{else if eq .Status "degraded"}}{{t "status.statuses.degraded"}}{{else if eq .Status "outage"}}{{t "status.statuses.outage"}}{{else}}{{t "status.statuses.unknown"}}{{end}} ({{printf "%.1f" .Uptime}}%)
                                    <div class="absolute top-full left-1/2 -translate-x-1/2 -mt-px">
                                        <div class="w-0 h-0 border-l-[4px] border-l-transparent border-r-[4px] border-r-transparent border-t-[4px] border-t-gray-900"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="w-2 h-8 rounded-sm cursor-pointer hover:opacity-80 hover:scale-y-110 hover:-translate-y-1 transition-all duration-200 ease-in-out transform-gpu {{if eq .Status "operational"}}bg-green-500{{else if eq .Status "degraded"}}bg-yellow-500{{else if eq .Status "outage"}}bg-red-500{{else}}bg-gray-300{{end}}"></div>
                        </div>
                        {{end}}
                    </div>
                </div>
                {{end}}
                {{else}}
                <!-- No data state -->
                <div class="text-center py-8">
                    <div class="text-gray-500 dark:text-gray-400">{{t "status.noData"}}</div>
                </div>
                {{end}}
            </div>
        </div>
        
        {{if .StatusData}}
        <!-- Last updated -->
        <div class="mt-8 text-center text-sm text-gray-500 dark:text-gray-400">
            {{t "status.lastUpdated"}}: {{.StatusData.Generated.Format "Jan 2, 2006 15:04:05 MST"}}
        </div>
        {{end}}
    </div>
        
