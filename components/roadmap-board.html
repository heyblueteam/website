{{- /* 
================================================================================
ROADMAP BOARD COMPONENT
================================================================================
Displays a kanban-style roadmap board with multiple status columns.

USAGE:
{{template "roadmap-board" $roadmapData}}

EXAMPLE IMPLEMENTATION:
{{$roadmapData := parseJSON `{
    "ideas": [
        {
            "title": "Voice Assistant Integration",
            "description": "Add voice commands for hands-free task management"
        }
    ],
    "planned": [
        {
            "title": "AI Suggested Workflows",
            "description": "Let AI analyze your processes and suggest automation workflows"
        },
        {
            "title": "Mobile App Redesign",
            "description": "Complete overhaul of mobile experience with new features"
        }
    ],
    "inProgress": [
        {
            "title": "Advanced Reporting",
            "description": "Export reports to PDF and Excel with custom branding"
        }
    ],
    "testing": [
        {
            "title": "Two-Factor Authentication",
            "description": "Enhanced security with TOTP-based 2FA support"
        }
    ],
    "MarginBottom": "mb-24"
}`}}
{{template "roadmap-board" $roadmapData}}


DATA STRUCTURE:
{
    "ideas": [                           // Ideas being considered (optional)
        {
            "title": "Feature Title",     // Feature name (required)
            "description": "Description"  // Feature description (required)
        }
    ],
    "planned": [...],                    // Features planned for development
    "inProgress": [...],                 // Features currently in development
    "testing": [...],                    // Features in testing phase
    "MarginBottom": "mb-16"              // Bottom margin (optional, default: mb-16)
}

FEATURES:
- 4-column kanban board layout
- Responsive grid (stacks on mobile)
- Fixed "Check out our changelog" link in Testing column
- Minimum height columns for consistency
- Dark mode support
- Clean card design

LAYOUT:
- Grid: 1 column mobile, 2 tablet, 4 desktop
- Gap: 6 units (1.5rem) between columns
- Column min-height: 400px
- Card spacing: 3 units (0.75rem) between cards
- Column padding: 4 units (1rem)

STYLING:
- Column headers: lg font size, semibold, gray-700
- Column borders: Gray-300, rounded-lg
- Card background: Gray-50 (dark: gray-700)
- Card border: Gray-200 (dark: gray-600)
- Card padding: 4 units (1rem)
- Title: Medium font weight
- Description: Small text, gray-600

SPECIAL FEATURES:
- Changelog link card:
  - Always visible in Testing column
  - Blue-50 background (stays light in dark mode)
  - Brand blue border (2px)
  - Links to /platform/changelog
  - Appears before other testing items

USE CASES:
- Product roadmap displays
- Feature planning visualization
- Development progress tracking
- Public roadmap pages
- Project status boards
*/ -}}
{{define "roadmap-board"}}
<div class="roadmap-container {{if .MarginBottom}}{{.MarginBottom}}{{else}}mb-16{{end}}"
     x-data="{
         magneticCards: {},
         currentColumn: 0,
         columns: 4,
         scrollContainer: null,
         isDragging: false,
         startX: 0,
         scrollLeft: 0,
         
         init() {
             this.scrollContainer = this.$refs.scrollContainer;
             this.updateCurrentColumn();
             
             // Update column on scroll
             this.scrollContainer.addEventListener('scroll', () => {
                 if (!this.isDragging) {
                     this.updateCurrentColumn();
                 }
             });
         },
         
         updateCurrentColumn() {
             const containerWidth = this.scrollContainer.offsetWidth;
             const scrollLeft = this.scrollContainer.scrollLeft;
             const columnWidth = this.scrollContainer.scrollWidth / this.columns;
             this.currentColumn = Math.round(scrollLeft / columnWidth);
         },
         
         scrollToColumn(index) {
             const containerWidth = this.scrollContainer.offsetWidth;
             const scrollWidth = this.scrollContainer.scrollWidth;
             const columnWidth = scrollWidth / this.columns;
             const targetScroll = columnWidth * index;
             
             this.scrollContainer.scrollTo({
                 left: targetScroll,
                 behavior: 'smooth'
             });
         },
         
         handleTouchStart(e) {
             this.isDragging = true;
             this.startX = e.touches[0].pageX - this.scrollContainer.offsetLeft;
             this.scrollLeft = this.scrollContainer.scrollLeft;
         },
         
         handleTouchMove(e) {
             if (!this.isDragging) return;
             e.preventDefault();
             const x = e.touches[0].pageX - this.scrollContainer.offsetLeft;
             const walk = (this.startX - x) * 1.5;
             this.scrollContainer.scrollLeft = this.scrollLeft + walk;
         },
         
         handleTouchEnd() {
             this.isDragging = false;
             this.updateCurrentColumn();
         },
         
         handleCardMagnetic(event, cardId) {
             const element = event.currentTarget;
             const rect = element.getBoundingClientRect();
             const centerX = rect.left + rect.width / 2;
             const centerY = rect.top + rect.height / 2;
             
             // Calculate distance from center (max 6px movement)
             const x = Math.max(-6, Math.min(6, (event.clientX - centerX) * 0.15));
             const y = Math.max(-6, Math.min(6, (event.clientY - centerY) * 0.15));
             
             this.magneticCards[cardId] = { x, y };
         },
         resetMagnetic(cardId) {
             this.magneticCards[cardId] = { x: 0, y: 0 };
         },
         getMagneticStyle(cardId) {
             const pos = this.magneticCards[cardId] || { x: 0, y: 0 };
             return `transform: translate(${pos.x}px, ${pos.y}px) scale(${pos.x || pos.y ? 1.02 : 1}); transition: all 200ms ease-out;`;
         }
     }">
    
    <!-- Mobile swipe container -->
    <div class="relative">
        <div class="kanban-scroll-container overflow-x-auto md:overflow-visible"
             x-ref="scrollContainer"
             @touchstart="handleTouchStart($event)"
             @touchmove="handleTouchMove($event)"
             @touchend="handleTouchEnd()">
            <div class="kanban-board flex md:grid gap-6 md:grid-cols-2 lg:grid-cols-4 w-full md:w-auto">
    <!-- Ideas Column -->
    <div class="kanban-column w-[85vw] md:w-auto">
        <h3 class="text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300">{{t "roadmap.columns.ideas"}}</h3>
        <div class="space-y-3 border border-gray-300 rounded-lg p-4 min-h-[400px]">
            {{range $index, $item := .ideas}}
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 transition-shadow hover:shadow-lg"
                 @mousemove="handleCardMagnetic($event, 'ideas-{{$index}}')"
                 @mouseleave="resetMagnetic('ideas-{{$index}}')"
                 :style="getMagneticStyle('ideas-{{$index}}')">
                <h3 class="font-medium text-gray-900 dark:text-white">{{.title}}</h3>
                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">{{.description}}</p>
            </div>
            {{end}}
        </div>
    </div>

    <!-- Planned Column -->
    <div class="kanban-column w-[85vw] md:w-auto">
        <h3 class="text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300">{{t "roadmap.columns.planned"}}</h3>
        <div class="space-y-3 border border-gray-300 rounded-lg p-4 min-h-[400px]">
            {{range $index, $item := .planned}}
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 transition-shadow hover:shadow-lg"
                 @mousemove="handleCardMagnetic($event, 'planned-{{$index}}')"
                 @mouseleave="resetMagnetic('planned-{{$index}}')"
                 :style="getMagneticStyle('planned-{{$index}}')">
                <h3 class="font-medium text-gray-900 dark:text-white">{{.title}}</h3>
                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">{{.description}}</p>
            </div>
            {{end}}
        </div>
    </div>

    <!-- In Progress Column -->
    <div class="kanban-column w-[85vw] md:w-auto">
        <h3 class="text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300">{{t "roadmap.columns.in_progress"}}</h3>
        <div class="space-y-3 border border-gray-300 rounded-lg p-4 min-h-[400px]">
            {{range $index, $item := .inProgress}}
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 transition-shadow hover:shadow-lg"
                 @mousemove="handleCardMagnetic($event, 'progress-{{$index}}')"
                 @mouseleave="resetMagnetic('progress-{{$index}}')"
                 :style="getMagneticStyle('progress-{{$index}}')">
                <h3 class="font-medium text-gray-900 dark:text-white">{{.title}}</h3>
                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">{{.description}}</p>
            </div>
            {{end}}
        </div>
    </div>

    <!-- Testing Column -->
    <div class="kanban-column w-[85vw] md:w-auto">
        <h3 class="text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300">{{t "roadmap.columns.testing"}}</h3>
        <div class="space-y-3 border border-gray-300 rounded-lg p-4 min-h-[400px]">
            <!-- Changelog Link Card - Always visible -->
            <a href="/platform/changelog" class="block">
                <div class="bg-blue-50 dark:bg-blue-50 rounded-lg p-4 border-2 border-brand-blue dark:border-brand-blue cursor-pointer transition-shadow hover:shadow-lg"
                     @mousemove="handleCardMagnetic($event, 'changelog')"
                     @mouseleave="resetMagnetic('changelog')"
                     :style="getMagneticStyle('changelog')">
                    <h3 class="font-medium text-gray-900 dark:text-gray-900">{{t "roadmap.changelog_card.title"}}</h3>
                    <p class="text-sm text-gray-600 dark:text-gray-600 mt-1">{{t "roadmap.changelog_card.description"}}</p>
                </div>
            </a>
            
            {{range $index, $item := .testing}}
            <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 transition-shadow hover:shadow-lg"
                 @mousemove="handleCardMagnetic($event, 'testing-{{$index}}')"
                 @mouseleave="resetMagnetic('testing-{{$index}}')"
                 :style="getMagneticStyle('testing-{{$index}}')">
                <h3 class="font-medium text-gray-900 dark:text-white">{{.title}}</h3>
                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">{{.description}}</p>
            </div>
            {{end}}
        </div>
    </div>
            </div>
        </div>
    </div>
</div>
{{end}}