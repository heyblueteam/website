---
title: Ta bort användare
description: Ta bort användare från projekt eller företag med hjälp av Blue API.
---

## Ta bort användare

Denna sida beskriver hur man tar bort användare från projekt och företag. Att ta bort en användare är en permanent åtgärd som avregistrerar användaren från alla poster och tar bort deras åtkomst, även om deras historiska data bevaras för revisionsändamål.

## Ta bort användare från projekt

Ta bort en användare från ett specifikt projekt samtidigt som deras företagsåtkomst bibehålls.

### Grundläggande exempel

```graphql
mutation {
  removeProjectUser(
    input: {
      projectId: "project-id"
      userId: "user-id"
    }
  ) {
    success
    operationId
  }
}
```

### Svarsexempel

```json
{
  "data": {
    "removeProjectUser": {
      "success": true,
      "operationId": null
    }
  }
}
```

**Observera:** Fältet `operationId` är för närvarande inte ifyllt av denna mutation och kommer att returnera `null`.

## Ta bort användare från företag

Ta bort en användare från hela företaget, vilket påverkar alla projekt.

### Grundläggande exempel

```graphql
mutation {
  removeCompanyUser(
    input: {
      companyId: "company-id"
      userId: "user-id"
    }
  )
}
```

### Svarsexempel

```json
{
  "data": {
    "removeCompanyUser": true
  }
}
```

## Indata parametrar

### RemoveProjectUserInput

| Parameter | Typ | Obligatorisk | Beskrivning |
|-----------|------|--------------|-------------|
| `projectId` | String! | ✅ Ja | ID för projektet (inte slug) |  |
| `userId` | String! | ✅ Ja | ID för användaren som ska tas bort |  |

### RemoveCompanyUserInput

| Parameter | Typ | Obligatorisk | Beskrivning |
|-----------|------|--------------|-------------|
| `companyId` | String! | ✅ Ja | ID eller slug för företaget |  |
| `userId` | String! | ✅ Ja | ID för användaren som ska tas bort |  |

## Svarsfält

### RemoveProjectUser Svar

| Fält | Typ | Beskrivning |
|-------|------|-------------|
| `success` | Boolean! | Om operationen var framgångsrik |  |
| `operationId` | String | Unik identifierare för operationen (returnerar för närvarande `null`) |  |

### RemoveCompanyUser Svar

Mutation av `removeCompanyUser` returnerar ett enkelt `Boolean` värde:
- `true` - Användaren togs bort framgångsrikt

## Obligatoriska behörigheter

### Projektanvändartagning

| Roll | Kan ta bort användare |
|------|-----------------------|
| `OWNER` | ✅ Ja |  |
| `ADMIN` | ✅ Ja |  |
| `MEMBER` | ❌ Nej |  |
| `READ_ONLY` | ❌ Nej |  |

**Viktiga anteckningar:**
- Du kan inte ta bort användare med `OWNER` roll från ett projekt
- Systemet förhindrar borttagning av projektägare för att upprätthålla projektägarskapsintegritet

### Företagsanvändartagning

| Roll | Kan ta bort användare |
|------|-----------------------|
| `OWNER` | ✅ Ja |  |
| `ADMIN` | ❌ Nej |  |
| `MEMBER` | ❌ Nej |  |
| `READ_ONLY` | ❌ Nej |  |

**Observera:** Endast företagsägare kan ta bort användare från företaget. Resolvern upprätthåller strikt ägaråtkomst för operationer för att ta bort företagsanvändare.

## Biverkningar

### Projektborttagning
- Tar bort alla todo-uppdrag för användaren i det projektet
- Tar bort användarens projektmappar
- Tar bort projektanvändarrelationen
- Skickar realtidsuppdateringar för att informera andra användare
- Skapar en revisionsloggpost

### Företagsborttagning
- **Kaskadborttagning över alla projekt:**
  - Tar bort alla todo-uppdrag i alla företagsprojekt
  - Tar bort alla projektanvändarmappar
  - Tar bort användaren från alla företagsprojekt
- Tar bort företagsanvändarmappar
- Tar bort användaren från företaget
- Skickar borttagningsmeddelande via e-post till den borttagna användaren
- **Uppdaterar fakturering (om prissättning per användare):**
  - Beräknar om antalet aktiva användare
  - Uppdaterar Stripe-prenumerationskvantitet
- Skapar en revisionsloggpost

## Felmeddelanden

### Projekt hittades inte
```json
{
  "errors": [{
    "message": "Project was not found.",
    "extensions": {
      "code": "PROJECT_NOT_FOUND"
    }
  }]
}
```

### Användare hittades inte
```json
{
  "errors": [{
    "message": "User was not found.",
    "extensions": {
      "code": "USER_NOT_FOUND"
    }
  }]
}
```

### Obefogad fel
```json
{
  "errors": [{
    "message": "You are not authorized.",
    "extensions": {
      "code": "FORBIDDEN"
    }
  }]
}
```

### Företag hittades inte (removeCompanyUser endast)
```json
{
  "errors": [{
    "message": "Company was not found.",
    "extensions": {
      "code": "COMPANY_NOT_FOUND"
    }
  }]
}
```

Detta fel inträffar när:
- Du saknar den erforderliga rollen (ÄGARE/ADMIN för projekt, ÄGARE för företag)
- Du försöker ta bort en projektägare
- Användaren är inte en del av projektet/företaget

## Viktiga överväganden

- **Databevarande**: Att ta bort en användare är inte reversibelt. Medan användaren förlorar åtkomst, bevaras deras historiska data (kommentarer, aktivitetsloggar, etc.) för revisionsändamål.
- **Ägarbeskydd**: Projektägare kan inte tas bort från projekt. Överför ägarskapet först om det behövs.
- **Fakturapåverkan**: Borttagning av företagsanvändare uppdaterar automatiskt din prenumeration om du har prissättning per användare.
- **E-postmeddelande**: Borttagning av företag skickar ett meddelande via e-post till den borttagna användaren.
- **Kaskadeffekt**: Borttagning av företag påverkar alla projekt, medan borttagning av projekt är isolerad till det specifika projektet.

## Relaterade operationer

- [Lista användare](/api/user-management/list-users) - Visa användare före borttagning
- [Hämta anpassad roll](/api/user-management/retrieve-custom-role) - Kontrollera användarbehörigheter
- [Skapa projekt](/api/projects/create-project) - Lägg till användare till nya projekt