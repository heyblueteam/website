---
title: Supprimer des utilisateurs
description: Supprimez des utilisateurs des projets ou des entreprises en utilisant l'API Blue.
---

## Supprimer des utilisateurs

Cette page couvre comment supprimer des utilisateurs des projets et des entreprises. La suppression d'un utilisateur est une action permanente qui désaffecte l'utilisateur de tous les enregistrements et supprime son accès, bien que ses données historiques soient préservées à des fins d'audit.

## Supprimer un utilisateur d'un projet

Supprimez un utilisateur d'un projet spécifique tout en maintenant son accès à l'entreprise.

### Exemple de base

```graphql
mutation {
  removeProjectUser(
    input: {
      projectId: "project-id"
      userId: "user-id"
    }
  ) {
    success
    operationId
  }
}
```

### Exemple de réponse

```json
{
  "data": {
    "removeProjectUser": {
      "success": true,
      "operationId": null
    }
  }
}
```

**Remarque :** Le champ `operationId` n'est actuellement pas peuplé par cette mutation et renverra `null`.

## Supprimer un utilisateur de l'entreprise

Supprimez un utilisateur de l'ensemble de l'entreprise, ce qui se propage à tous les projets.

### Exemple de base

```graphql
mutation {
  removeCompanyUser(
    input: {
      companyId: "company-id"
      userId: "user-id"
    }
  )
}
```

### Exemple de réponse

```json
{
  "data": {
    "removeCompanyUser": true
  }
}
```

## Paramètres d'entrée

### RemoveProjectUserInput

| Paramètre | Type | Requis | Description |
|-----------|------|--------|-------------|
| `projectId` | String! | ✅ Oui | L'ID du projet (pas le slug) |  |
| `userId` | String! | ✅ Oui | L'ID de l'utilisateur à supprimer |  |

### RemoveCompanyUserInput

| Paramètre | Type | Requis | Description |
|-----------|------|--------|-------------|
| `companyId` | String! | ✅ Oui | L'ID ou le slug de l'entreprise |  |
| `userId` | String! | ✅ Oui | L'ID de l'utilisateur à supprimer |  |

## Champs de réponse

### Réponse RemoveProjectUser

| Champ | Type | Description |
|-------|------|-------------|
| `success` | Boolean! | Indique si l'opération a réussi |  |
| `operationId` | String | Identifiant unique pour l'opération (renvoie actuellement `null`) |  |

### Réponse RemoveCompanyUser

La mutation `removeCompanyUser` renvoie une simple valeur `Boolean` :
- `true` - L'utilisateur a été supprimé avec succès

## Permissions requises

### Suppression d'utilisateur de projet

| Rôle | Peut supprimer des utilisateurs |
|------|-------------------------------|
| `OWNER` | ✅ Oui |  |
| `ADMIN` | ✅ Oui |  |
| `MEMBER` | ❌ Non |  |
| `READ_ONLY` | ❌ Non |  |

**Remarques importantes :**
- Vous ne pouvez pas supprimer des utilisateurs avec le rôle `OWNER` d'un projet
- Le système empêche la suppression des propriétaires de projet pour maintenir l'intégrité de la propriété du projet

### Suppression d'utilisateur de l'entreprise

| Rôle | Peut supprimer des utilisateurs |
|------|-------------------------------|
| `OWNER` | ✅ Oui |  |
| `ADMIN` | ❌ Non |  |
| `MEMBER` | ❌ Non |  |
| `READ_ONLY` | ❌ Non |  |

**Remarque :** Seuls les propriétaires d'entreprise peuvent supprimer des utilisateurs de l'entreprise. Le résolveur impose un accès strict réservé aux PROPRIÉTAIRES pour les opérations de suppression d'utilisateur d'entreprise.

## Effets secondaires

### Suppression de projet
- Supprime toutes les affectations de tâches pour l'utilisateur dans ce projet
- Supprime les dossiers de projet de l'utilisateur
- Supprime la relation utilisateur-projet
- Envoie des mises à jour en temps réel pour notifier les autres utilisateurs
- Crée une entrée dans le journal d'audit

### Suppression d'entreprise
- **Suppression en cascade à travers tous les projets :**
  - Supprime toutes les affectations de tâches dans tous les projets de l'entreprise
  - Supprime tous les dossiers d'utilisateur de projet
  - Supprime l'utilisateur de tous les projets de l'entreprise
- Supprime les dossiers d'utilisateur de l'entreprise
- Supprime l'utilisateur de l'entreprise
- Envoie un e-mail de notification de suppression à l'utilisateur supprimé
- **Met à jour la facturation (si tarification par utilisateur) :**
  - Recalcule le nombre d'utilisateurs actifs
  - Met à jour la quantité d'abonnement Stripe
- Crée une entrée dans le journal d'audit

## Réponses d'erreur

### Projet non trouvé
```json
{
  "errors": [{
    "message": "Project was not found.",
    "extensions": {
      "code": "PROJECT_NOT_FOUND"
    }
  }]
}
```

### Utilisateur non trouvé
```json
{
  "errors": [{
    "message": "User was not found.",
    "extensions": {
      "code": "USER_NOT_FOUND"
    }
  }]
}
```

### Erreur non autorisée
```json
{
  "errors": [{
    "message": "You are not authorized.",
    "extensions": {
      "code": "FORBIDDEN"
    }
  }]
}
```

### Entreprise non trouvée (removeCompanyUser uniquement)
```json
{
  "errors": [{
    "message": "Company was not found.",
    "extensions": {
      "code": "COMPANY_NOT_FOUND"
    }
  }]
}
```

Cette erreur se produit lorsque :
- Vous n'avez pas le rôle requis (PROPRIÉTAIRE/ADMIN pour les projets, PROPRIÉTAIRE pour l'entreprise)
- Vous essayez de supprimer un PROPRIÉTAIRE de projet
- L'utilisateur ne fait pas partie du projet/de l'entreprise

## Considérations importantes

- **Préservation des données :** La suppression d'un utilisateur n'est pas réversible. Bien que l'utilisateur perde l'accès, ses données historiques (commentaires, journaux d'activité, etc.) sont préservées à des fins d'audit.
- **Protection des propriétaires :** Les propriétaires de projet ne peuvent pas être supprimés des projets. Transférez d'abord la propriété si nécessaire.
- **Impact sur la facturation :** La suppression d'un utilisateur d'entreprise met automatiquement à jour votre abonnement si vous êtes sur une tarification par utilisateur.
- **Notification par e-mail :** La suppression d'entreprise envoie un e-mail de notification à l'utilisateur supprimé.
- **Effet de cascade :** La suppression d'entreprise affecte tous les projets, tandis que la suppression de projet est isolée à ce projet spécifique.

## Opérations connexes

- [Lister les utilisateurs](/api/user-management/list-users) - Voir les utilisateurs avant la suppression
- [Récupérer un rôle personnalisé](/api/user-management/retrieve-custom-role) - Vérifier les permissions de l'utilisateur
- [Créer un projet](/api/projects/create-project) - Ajouter des utilisateurs à de nouveaux projets