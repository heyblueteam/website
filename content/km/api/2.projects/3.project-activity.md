---
title: សកម្មភាពគម្រោង
description: ទាញយក និងតាមដានអត្ថបទសកម្មភាពគម្រោងដោយប្រើ Blue API។
---

## ទាញយកសកម្មភាពគម្រោង

ការស្នើសុំ `activityList` ផ្តល់ការចូលដំណើរការទៅកាន់អត្ថបទសកម្មភាពពេញលេញសម្រាប់គម្រោង និងក្រុមហ៊ុន។ សកម្មភាពត្រូវបានបង្កើតដោយស្វ័យប្រវត្តិពេលដែលអ្នកប្រើប្រាស់អនុវត្តសកម្មភាពដូចជា បង្កើត todo, ការពិភាក្សា, ឬធ្វើបម្លែងគម្រោង។

### ឧទាហរណ៍មូលដ្ឋាន

```graphql
query ProjectActivity {
  activityList(
    projectId: "your-project-id"
    first: 20
    orderBy: createdAt_DESC
  ) {
    activities {
      id
      category
      html
      createdAt
      createdBy {
        id
        name
        email
      }
      project {
        id
        name
      }
    }
    pageInfo {
      hasNextPage
      endCursor
    }
    totalCount
  }
}
```

### ឧទាហរណ៍កម្រិតខ្ពស់ជាមួយការតម្រង

```graphql
query FilteredActivity {
  activityList(
    companyId: "your-company-id"
    categories: [CREATE_TODO, MARK_TODO_AS_COMPLETE, CREATE_COMMENT]
    userIds: ["user1-id", "user2-id"]
    startDate: "2024-01-01T00:00:00Z"
    endDate: "2024-12-31T23:59:59Z"
    first: 50
    orderBy: createdAt_DESC
  ) {
    activities {
      id
      uid
      category
      html
      createdAt
      updatedAt
      createdBy {
        id
        name
        email
      }
      affectedBy {
        id
        name
      }
      todo {
        id
        title
      }
      comment {
        id
        text
      }
      project {
        id
        name
        slug
      }
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      startCursor
      endCursor
    }
    totalCount
  }
}
```

## ប៉ារ៉ាម៉ែត្រ​ចូល

### សំណើ activityList

| ប៉ារ៉ាម៉ែត្រ | ប្រភេទ | ត្រូវការ | ការពិពណ៌នា |
|-----------|------|----------|-------------|
| `companyId` | String | ទេ | តម្រងសកម្មភាពដោយ ID ឬ slug របស់ក្រុមហ៊ុន |  |
| `projectId` | String | ទេ | តម្រងសកម្មភាពដោយ ID ឬ slug របស់គម្រោង |  |
| `userId` | String | ទេ | តម្រងសកម្មភាពដោយអ្នកប្រើប្រាស់ជាក់លាក់ |  |
| `userIds` | [String!] | ទេ | តម្រងសកម្មភាពដោយអ្នកប្រើប្រាស់ជាច្រើន |  |
| `tagIds` | [String!] | ទេ | តម្រងសកម្មភាពដោយស្លាក todo |  |
| `categories` | [ActivityCategory!] | ទេ | តម្រងដោយប្រភេទសកម្មភាពជាក់លាក់ |  |
| `startDate` | DateTime | ទេ | តម្រងសកម្មភាពពីកាលបរិច្ឆេទនេះ |  |
| `endDate` | DateTime | ទេ | តម្រងសកម្មភាពរហូតដល់កាលបរិច្ឆេទនេះ |  |
| `skip` | Int | ទេ | លើសសំណុំឯកសារនេះ (ការបង្ហាញទំព័រ) |  |
| `first` | Int | ទេ | ត្រឡប់មកវិញ N ឯកសារ ដំបូង (ការបង្ហាញទំព័រ) |  |
| `last` | Int | ទេ | ត្រឡប់មកវិញ N ឯកសារចុងក្រោយ (ការបង្ហាញទំព័រ) |  |
| `after` | String | ទេ | ត្រឡប់មកវិញឯកសារបន្ទាប់ពីស្លាកនេះ |  |
| `before` | String | ទេ | ត្រឡប់មកវិញឯកសារមុនស្លាកនេះ |  |
| `orderBy` | ActivityOrderByInput | ទេ | លំដាប់ការស្វែងរកសម្រាប់លទ្ធផល |  |

### តម្លៃ ActivityCategory

ប្រព័ន្ធតាមដានប្រភេទសកម្មភាពជាច្រើនដោយស្វ័យប្រវត្តិ៖

| ប្រភេទ | ការពិពណ៌នា |
|----------|-------------|
| `CREATE_TODO` | ត្រូវបានបង្កើត todo/ការងារថ្មី |  |
| `MARK_TODO_AS_COMPLETE` | todo ត្រូវបានសម្គាល់ថាបញ្ចប់ |  |
| `CREATE_COMMENT` | ការពិភាក្សាត្រូវបានបន្ថែម |  |
| `CREATE_DISCUSSION` | ការពិភាក្សាត្រូវបានចាប់ផ្តើម |  |
| `CREATE_STATUS_UPDATE` | ការអាប់ដេតស្ថានភាពត្រូវបានបង្ហោះ |  |
| `CREATE_TODO_LIST` | ត្រូវបានបង្កើតបញ្ជី todo ថ្មី |  |
| `MOVE_TODO` | todo ត្រូវបានផ្លាស់ប្តូរវិញក្នុងបញ្ជី |  |
| `COPY_TODO` | todo ត្រូវបានចម្លង |  |
| `ADD_USER_TO_PROJECT` | អ្នកប្រើប្រាស់ត្រូវបានបន្ថែមទៅគម្រោង |  |
| `REMOVE_USER_FROM_PROJECT` | អ្នកប្រើប្រាស់ត្រូវបានយកចេញពីគម្រោង |  |
| `ARCHIVE_PROJECT` | គម្រោងត្រូវបានដាក់ស្តុក |  |
| `UNARCHIVE_PROJECT` | គម្រោងត្រូវបានដោះស្រាយ |  |
| `CREATE_INVITATION` | អ្នកប្រើប្រាស់ត្រូវបានអញ្ជើញ |  |
| `ACCEPT_INVITATION` | ការអញ្ជើញត្រូវបានទទួល |  |
| `CREATE_CUSTOM_FIELD` | វាលកំណត់ត្រូវបានបង្កើត |  |
| `RECEIVE_FORM` | ការដាក់ស្នើទម្រង់ត្រូវបានទទួល |  |

### តម្លៃ ActivityOrderByInput

| តម្លៃ | ការពិពណ៌នា |
|-------|-------------|
| `createdAt_DESC` | ថ្មីបំផុតមុន (លំនាំដើម) |  |
| `createdAt_ASC` | ចាស់បំផុតមុន |  |
| `updatedAt_DESC` | បានអាប់ដេតថ្មីបំផុតមុន |  |
| `updatedAt_ASC` | បានអាប់ដេតតិចបំផុតមុន |  |
| `category_ASC` | តាមអក្សរ​ដើម្បីប្រភេទ |  |
| `category_DESC` | តាមអក្សរប្រឆាំងដោយប្រភេទ |  |

## វាលឆ្លើយតប

### ប្រភេទសកម្មភាព

| វាល | ប្រភេទ | ការពិពណ៌នា |
|-------|------|-------------|
| `id` | ID! | អត្តសញ្ញាណដ៏ឯកត្តសម្រាប់សកម្មភាព |  |
| `uid` | String! | អត្តសញ្ញាណដ៏ឯកត្តផ្សេងទៀត |  |
| `category` | ActivityCategory! | ប្រភេទសកម្មភាពដែលកើតឡើង |  |
| `html` | String! | ការពិពណ៌នាផ្ទាល់ខ្លួន HTML ធំសម្រាប់សកម្មភាព |  |
| `createdAt` | DateTime! | ពេលដែលសកម្មភាពកើតឡើង |  |
| `updatedAt` | DateTime! | ពេលដែលសកម្មភាពបានអាប់ដេតចុងក្រោយ |  |
| `createdBy` | User! | អ្នកប្រើប្រាស់ដែលបានអនុវត្តសកម្មភាព |  |
| `affectedBy` | User | អ្នកប្រើប្រាស់ដែលបានប៉ះពាល់ដោយសកម្មភាព |  |
| `company` | Company | ក្រុមហ៊ុនដែលពាក់ព័ន្ធ |  |
| `project` | Project | គម្រោងដែលពាក់ព័ន្ធ |  |
| `todo` | Todo | todo ដែលពាក់ព័ន្ធ (ប្រសិនបើអាច) |  |
| `todoList` | TodoList | បញ្ជី todo ដែលពាក់ព័ន្ធ (ប្រសិនបើអាច) |  |
| `comment` | Comment | ការពិភាក្សាដែលពាក់ព័ន្ធ (ប្រសិនបើអាច) |  |
| `discussion` | Discussion | ការពិភាក្សាដែលពាក់ព័ន្ធ (ប្រសិនបើអាច) |  |
| `statusUpdate` | StatusUpdate | ការអាប់ដេតស្ថានភាពដែលពាក់ព័ន្ធ (ប្រសិនបើអាច) |  |
| `metadata` | String | ព័ត៌មានបន្ថែមអំពីសកម្មភាព |  |

### ចម្លើយ ActivityList

| វាល | ប្រភេទ | ការពិពណ៌នា |
|-------|------|-------------|
| `activities` | [Activity!]! | អារ៉ាយនៃកំណត់ត្រាសកម្មភាព |  |
| `pageInfo` | PageInfo! | ព័ត៌មានការបង្ហាញទំព័រ |  |
| `totalCount` | Int! | ចំនួនសកម្មភាពសរុបដែលសម្របសម្រួលតាមតម្រូវការ |  |

## ការអាប់ដេតសកម្មភាពពេលវេលាពិត

ចុះឈ្មោះដើម្បីទទួលបានការផ្លាស់ប្តូរសកម្មភាពដោយប្រើការចុះឈ្មោះ `subscribeToActivity`:

```graphql
subscription ActivityUpdates($companyId: String!, $projectId: String) {
  subscribeToActivity(companyId: $companyId, projectId: $projectId) {
    mutation
    node {
      id
      category
      html
      createdAt
      createdBy {
        id
        name
        email
      }
      project {
        id
        name
      }
    }
  }
}
```

### ប៉ារ៉ាម៉ែត្រ​ចុះឈ្មោះ

| ប៉ារ៉ាម៉ែត្រ | ប្រភេទ | ត្រូវការ | ការពិពណ៌នា |
|-----------|------|----------|-------------|
| `companyId` | String | ទេ | ចុះឈ្មោះសម្រាប់សកម្មភាពទូទាំងក្រុមហ៊ុន |  |
| `projectId` | String | ទេ | ចុះឈ្មោះសម្រាប់សកម្មភាពគម្រោងជាក់លាក់ |  |

ការចុះឈ្មោះនឹងជូនដំណឹងអ្នកអំពី:
- `ACTIVITY_CREATED` - សកម្មភាពថ្មី
- `ACTIVITY_UPDATED` - សកម្មភាពដែលបានកែប្រែ  
- `ACTIVITY_DELETED` - សកម្មភាពដែលបានយកចេញ

## ការតម្រង និងឯកជនភាព

### ការតម្រងដោយស្វ័យប្រវត្តិ

អត្ថបទសកម្មភាពត្រូវបានតម្រងដោយស្វ័យប្រវត្តិដោយផ្អែកលើ៖

- **ការកំណត់គម្រោង**: បង្ហាញតែសកម្មភាពពីគម្រោងដែលមានការតាមដានសកម្មភាពបានបើក
- **អាជ្ញាប័ណ្ណអ្នកប្រើប្រាស់**: តួនាទីអ្នកប្រើប្រាស់ខុសគ្នាឃើញប្រភេទសកម្មភាពខុសគ្នា
- **សមាជិកគម្រោង**: អ្នកប្រើប្រាស់គ្រាន់តែឃើញសកម្មភាពពីគម្រោងដែលពួកគេមានការចូលដំណើរការ
- **សមាជិកក្រុមហ៊ុន**: សកម្មភាពត្រូវបានកំណត់ទៅកាន់ក្រុមហ៊ុនរបស់អ្នកប្រើប្រាស់

### ការពិចារណាអំពីឯកជនភាព

- អ្នកប្រើប្រាស់តួនាទី CLIENT មានការមើលឃើញដ៏មានកំណត់ចំពោះសកម្មភាពគ្រប់គ្រងខ្លះ
- សកម្មភាពគោរពការកំណត់ឯកជនភាពនៅកម្រិតគម្រោង
- ប្រតិបត្តិការដែលមានអារម្មណ៍អារម្មណ៍អាចមិនបង្កើតសកម្មភាពសាធារណៈ

## ការឆ្លើយតបកំហុស

### គម្រោង/ក្រុមហ៊ុនមិនត្រឹមត្រូវ
```json
{
  "errors": [{
    "message": "Project not found",
    "extensions": {
      "code": "NOT_FOUND"
    }
  }]
}
```

### អនុញ្ញាតមិនត្រូវបានអនុញ្ញាត
```json
{
  "errors": [{
    "message": "You do not have permission to view activities for this project",
    "extensions": {
      "code": "FORBIDDEN"
    }
  }]
}
```

### កាលបរិច្ឆេទមិនត្រឹមត្រូវ
```json
{
  "errors": [{
    "message": "Start date must be before end date",
    "extensions": {
      "code": "BAD_USER_INPUT"
    }
  }]
}
```

## អនុសាសន៍ល្អ

1. **ប្រើការបង្ហាញទំព័រ**: អត្ថបទសកម្មភាពអាចធំធេង ចូរប្រើប្រាស់ប៉ារ៉ាម៉ែត្រ `first`
2. **តម្រងតាមគម្រោង**: អត្ថបទសកម្មភាពទូទាំងក្រុមហ៊ុនអាចធ្វើអោយមានការលំបាក
3. **អាប់ដេតពេលវេលាពិត**: ប្រើការចុះឈ្មោះសម្រាប់អត្ថបទសកម្មភាពរស់
4. **ការតម្រងកាលបរិច្ឆេទ**: ប្រើកាលបរិច្ឆេទសម្រាប់ការវិភាគសកម្មភាពប្រវត្តិសាស្ត្រ
5. **ការតម្រងប្រភេទ**: តម្រងតាមប្រភេទសកម្មភាពជាក់លាក់សម្រាប់អត្ថបទដែលមានគោលបំណង
6. **ការតម្រងអ្នកប្រើប្រាស់**: តាមដានសកម្មភាពរបស់សមាជិកក្រុមជាក់លាក់ដោយប្រើ `userIds`

## កំណត់ចំណាំសំខាន់

- សកម្មភាពត្រូវបានបង្កើតដោយស្វ័យប្រវត្តិ និងមិនអាចបង្កើតដោយដៃតាម API
- អត្ថបទសកម្មភាពប្រើប្រាស់ការបង្ហាញ HTML សម្រាប់ការបង្ហាញដ៏សម្បូរបែប
- វាល `text` ត្រូវបានលុបចេញដោយសារតែ `html`
- សកម្មភាពត្រូវបានរក្សាទុកយ៉ាងថេរ និងផ្តល់នូវស្នាមបញ្ជាក់ពេញលេញ
- ការចុះឈ្មោះពេលវេលាពិតត្រូវការការផ្ទៀងផ្ទាត់ការតភ្ជាប់ WebSocket